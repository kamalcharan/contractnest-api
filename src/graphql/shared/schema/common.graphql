# src/graphql/shared/schema/common.graphql
# Shared types, pagination, and common patterns used across all GraphQL schemas
# Provides reusable components for consistent API design

# =================================================================
# COMMON ENUMS
# =================================================================

"""
Enum for sort direction
"""
enum SortDirection {
  ASC
  DESC
}

"""
Standard environment types
"""
enum Environment {
  LIVE
  TEST
}

"""
Common status types
"""
enum Status {
  ACTIVE
  INACTIVE
  DRAFT
  PENDING
  ARCHIVED
}

"""
Content format types for rich text fields
"""
enum ContentFormat {
  PLAIN
  MARKDOWN
  HTML
}

"""
Audit severity levels
"""
enum AuditSeverity {
  INFO
  WARNING
  ERROR
  CRITICAL
}

"""
Operation result status
"""
enum OperationStatus {
  SUCCESS
  PARTIAL_SUCCESS
  FAILURE
  IN_PROGRESS
  CANCELLED
}

"""
File upload status
"""
enum UploadStatus {
  PENDING
  UPLOADING
  COMPLETED
  FAILED
  CANCELLED
}

# =================================================================
# PAGINATION TYPES
# =================================================================

"""
Input for pagination
"""
input PaginationInput {
  """
  Page number (1-based)
  """
  page: PositiveInt
  
  """
  Number of items per page (max 1000)
  """
  limit: PositiveInt
  
  """
  Cursor for cursor-based pagination
  """
  cursor: String
  
  """
  Offset for offset-based pagination
  """
  offset: NonNegativeInt
}

"""
Pagination information for responses
"""
type PaginationInfo {
  """
  Total number of items
  """
  total: NonNegativeInt!
  
  """
  Current page number
  """
  page: PositiveInt!
  
  """
  Number of items per page
  """
  limit: PositiveInt!
  
  """
  Whether there are more items
  """
  has_more: Boolean!
  
  """
  Total number of pages
  """
  total_pages: PositiveInt!
  
  """
  Cursor for next page (cursor-based pagination)
  """
  next_cursor: String
  
  """
  Cursor for previous page (cursor-based pagination)
  """
  prev_cursor: String
}

"""
Edge type for cursor-based pagination
"""
type Edge {
  """
  The cursor for this edge
  """
  cursor: String!
  
  """
  The node for this edge
  """
  node: Node!
}

"""
Connection type for cursor-based pagination
"""
type Connection {
  """
  The edges for this connection
  """
  edges: [Edge!]!
  
  """
  Page info for this connection
  """
  page_info: PageInfo!
  
  """
  Total count (may be expensive to compute)
  """
  total_count: NonNegativeInt
}

"""
Page info for cursor connections
"""
type PageInfo {
  """
  Whether there is a next page
  """
  has_next_page: Boolean!
  
  """
  Whether there is a previous page
  """
  has_previous_page: Boolean!
  
  """
  Cursor for the first edge
  """
  start_cursor: String
  
  """
  Cursor for the last edge
  """
  end_cursor: String
}

"""
Base node interface
"""
interface Node {
  """
  Unique identifier
  """
  id: UUID!
}

# =================================================================
# SORTING TYPES
# =================================================================

"""
Generic sort input for any field
"""
input GenericSortInput {
  """
  Field name to sort by
  """
  field: NonEmptyString!
  
  """
  Sort direction
  """
  direction: SortDirection
}

"""
Multiple sort criteria
"""
input MultiSortInput {
  """
  Primary sort criteria
  """
  primary: GenericSortInput!
  
  """
  Secondary sort criteria
  """
  secondary: [GenericSortInput!]
}

# =================================================================
# FILTERING TYPES
# =================================================================

"""
Date range filter (INPUT TYPE for filtering)
"""
input DateRangeFilter {
  """
  Start date (inclusive)
  """
  from: DateTime
  
  """
  End date (inclusive)
  """
  to: DateTime
  
  """
  Relative time period (e.g., "last_7_days", "this_month")
  """
  period: String
}

"""
Date range (OUTPUT TYPE for responses)
"""
type DateRange {
  """
  Start date (inclusive)
  """
  from: DateTime
  
  """
  End date (inclusive)
  """
  to: DateTime
  
  """
  Relative time period (e.g., "last_7_days", "this_month")
  """
  period: String
}

"""
Number range filter
"""
input NumberRangeFilter {
  """
  Minimum value (inclusive)
  """
  min: Float
  
  """
  Maximum value (inclusive)
  """
  max: Float
  
  """
  Exact value
  """
  equals: Float
  
  """
  Greater than
  """
  gt: Float
  
  """
  Greater than or equal
  """
  gte: Float
  
  """
  Less than
  """
  lt: Float
  
  """
  Less than or equal
  """
  lte: Float
  
  """
  Not equal to
  """
  not: Float
  
  """
  Value is in list
  """
  in: [Float!]
  
  """
  Value is not in list
  """
  not_in: [Float!]
}

"""
String filter options
"""
input StringFilter {
  """
  Exact match
  """
  equals: String
  
  """
  Case-insensitive exact match
  """
  equals_ignore_case: String
  
  """
  Contains substring
  """
  contains: String
  
  """
  Case-insensitive contains
  """
  contains_ignore_case: String
  
  """
  Starts with
  """
  starts_with: String
  
  """
  Case-insensitive starts with
  """
  starts_with_ignore_case: String
  
  """
  Ends with
  """
  ends_with: String
  
  """
  Case-insensitive ends with
  """
  ends_with_ignore_case: String
  
  """
  Not equal to
  """
  not: String
  
  """
  Value is in list
  """
  in: [String!]
  
  """
  Value is not in list
  """
  not_in: [String!]
  
  """
  Matches regular expression
  """
  regex: String
  
  """
  Full text search
  """
  search: String
}

"""
Boolean filter options
"""
input BooleanFilter {
  """
  Exact boolean value
  """
  equals: Boolean
  
  """
  Not equal to
  """
  not: Boolean
}

"""
UUID filter options
"""
input UUIDFilter {
  """
  Exact match
  """
  equals: UUID
  
  """
  Not equal to
  """
  not: UUID
  
  """
  Value is in list
  """
  in: [UUID!]
  
  """
  Value is not in list
  """
  not_in: [UUID!]
}

# =================================================================
# RESPONSE TYPES
# =================================================================

"""
Base response interface
"""
interface Response {
  """
  Whether the operation was successful
  """
  success: Boolean!
  
  """
  Human-readable message
  """
  message: String
  
  """
  Timestamp of the response
  """
  timestamp: DateTime!
}

"""
Standard mutation response
"""
type MutationResponse implements Response {
  """
  Whether the operation was successful
  """
  success: Boolean!
  
  """
  Human-readable message
  """
  message: String
  
  """
  Error messages if any
  """
  errors: [String!]
  
  """
  Warning messages if any
  """
  warnings: [String!]
  
  """
  Timestamp of the response
  """
  timestamp: DateTime!
}

"""
Bulk operation response
"""
type BulkOperationResponse implements Response {
  """
  Whether the operation was successful
  """
  success: Boolean!
  
  """
  Human-readable message
  """
  message: String
  
  """
  Total number of items requested
  """
  total_requested: NonNegativeInt!
  
  """
  Number of items successfully processed
  """
  successful: NonNegativeInt!
  
  """
  Number of items that failed
  """
  failed: NonNegativeInt!
  
  """
  Individual error details
  """
  errors: [BulkOperationError!]!
  
  """
  IDs of successfully created items (for create operations)
  """
  created_ids: [UUID!]
  
  """
  IDs of successfully updated items (for update operations)
  """
  updated_ids: [UUID!]
  
  """
  Timestamp of the response
  """
  timestamp: DateTime!
}

"""
Bulk operation error details
"""
type BulkOperationError {
  """
  Index of the item in the batch that failed
  """
  item_index: NonNegativeInt!
  
  """
  ID of the item that failed (if available)
  """
  item_id: UUID
  
  """
  Error message
  """
  error: String!
  
  """
  Error code
  """
  code: String
  
  """
  Additional error details
  """
  details: JSON
}

# =================================================================
# VALIDATION TYPES
# =================================================================

"""
Validation result
"""
type ValidationResult {
  """
  Whether validation passed
  """
  is_valid: Boolean!
  
  """
  Validation errors
  """
  errors: [ValidationError!]!
  
  """
  Validation warnings
  """
  warnings: [ValidationError!]!
}

"""
Individual validation error
"""
type ValidationError {
  """
  Field that failed validation
  """
  field: String!
  
  """
  Error message
  """
  message: String!
  
  """
  Error code
  """
  code: String!
  
  """
  Value that failed validation
  """
  value: JSON
  
  """
  Additional error context
  """
  context: JSON
}

# =================================================================
# AUDIT TYPES
# =================================================================

"""
Audit trail entry
"""
type AuditEntry implements Node {
  """
  Unique identifier
  """
  id: UUID!
  
  """
  Tenant ID
  """
  tenant_id: UUID!
  
  """
  User who performed the action
  """
  user_id: UUID
  
  """
  User email
  """
  user_email: String
  
  """
  Action performed
  """
  action: String!
  
  """
  Resource affected
  """
  resource: String!
  
  """
  Resource ID
  """
  resource_id: UUID
  
  """
  Whether the action was successful
  """
  success: Boolean!
  
  """
  Error message if failed
  """
  error_message: String
  
  """
  Additional metadata
  """
  metadata: JSON
  
  """
  Severity level
  """
  severity: AuditSeverity!
  
  """
  IP address
  """
  ip_address: String
  
  """
  User agent
  """
  user_agent: String
  
  """
  Session ID
  """
  session_id: String
  
  """
  When the action occurred
  """
  created_at: DateTime!
}

"""
Audit summary statistics
"""
type AuditSummary {
  """
  Total audit entries
  """
  total_entries: NonNegativeInt!
  
  """
  Entries by severity
  """
  by_severity: [AuditSeverityCount!]!
  
  """
  Entries by action
  """
  by_action: [AuditActionCount!]!
  
  """
  Entries by user
  """
  by_user: [AuditUserCount!]!
  
  """
  Recent entries
  """
  recent_entries: [AuditEntry!]!
  
  """
  Date range covered (OUTPUT TYPE)
  """
  date_range: DateRange
}

"""
Audit count by severity
"""
type AuditSeverityCount {
  """
  Severity level
  """
  severity: AuditSeverity!
  
  """
  Number of entries
  """
  count: NonNegativeInt!
}

"""
Audit count by action
"""
type AuditActionCount {
  """
  Action name
  """
  action: String!
  
  """
  Number of entries
  """
  count: NonNegativeInt!
}

"""
Audit count by user
"""
type AuditUserCount {
  """
  User ID
  """
  user_id: UUID!
  
  """
  User email
  """
  user_email: String
  
  """
  Number of entries
  """
  count: NonNegativeInt!
}

# =================================================================
# HEALTH CHECK TYPES
# =================================================================

"""
Service health status
"""
type HealthStatus {
  """
  Overall status
  """
  status: String!
  
  """
  Timestamp of health check
  """
  timestamp: DateTime!
  
  """
  Individual service statuses
  """
  services: ServiceStatuses!
  
  """
  Environment information
  """
  environment: String!
  
  """
  Version information
  """
  version: String
  
  """
  Uptime in seconds
  """
  uptime: NonNegativeFloat
}

"""
Individual service statuses
"""
type ServiceStatuses {
  """
  Database connection status
  """
  database: String!
  
  """
  Audit service status
  """
  audit: String!
  
  """
  Edge functions status
  """
  edge_functions: String!
  
  """
  Cache service status
  """
  cache: String
  
  """
  File storage status
  """
  storage: String
  
  """
  External API statuses
  """
  external_apis: JSON
}

# =================================================================
# FILE UPLOAD TYPES
# =================================================================

"""
File upload information
"""
type FileUpload implements Node {
  """
  Unique identifier
  """
  id: UUID!
  
  """
  Original filename
  """
  filename: String!
  
  """
  MIME type
  """
  mime_type: MIMEType!
  
  """
  File size in bytes
  """
  size: NonNegativeInt!
  
  """
  Upload status
  """
  status: UploadStatus!
  
  """
  Download URL (if completed)
  """
  url: URL
  
  """
  Thumbnail URL (for images)
  """
  thumbnail_url: URL
  
  """
  Upload progress (0-100)
  """
  progress: NonNegativeFloat
  
  """
  Error message (if failed)
  """
  error_message: String
  
  """
  Metadata about the file
  """
  metadata: JSON
  
  """
  When the upload was created
  """
  created_at: DateTime!
  
  """
  When the upload was completed
  """
  completed_at: DateTime
  
  """
  Expiration date for temporary files
  """
  expires_at: DateTime
}

"""
File upload input
"""
input FileUploadInput {
  """
  File to upload
  """
  file: Upload!
  
  """
  Alternative filename
  """
  filename: String
  
  """
  Whether file is temporary
  """
  is_temporary: Boolean
  
  """
  Expiration time for temporary files
  """
  expires_in_hours: PositiveInt
  
  """
  Additional metadata
  """
  metadata: JSON
}

# =================================================================
# SEARCH TYPES
# =================================================================

"""
Search configuration
"""
input SearchInput {
  """
  Search query string
  """
  query: String!
  
  """
  Fields to search in
  """
  fields: [String!]
  
  """
  Search options
  """
  options: SearchOptions
}

"""
Search options
"""
input SearchOptions {
  """
  Whether to use fuzzy matching
  """
  fuzzy: Boolean
  
  """
  Minimum similarity for fuzzy search (0-1)
  """
  min_similarity: Float
  
  """
  Maximum number of suggestions
  """
  max_suggestions: PositiveInt
  
  """
  Whether to highlight matches
  """
  highlight: Boolean
  
  """
  Whether search is case sensitive
  """
  case_sensitive: Boolean
}

"""
Search result information
"""
type SearchInfo {
  """
  Original search query
  """
  query: String!
  
  """
  Total number of results
  """
  total_results: NonNegativeInt!
  
  """
  Search execution time in milliseconds
  """
  search_time_ms: NonNegativeFloat!
  
  """
  Search suggestions
  """
  suggestions: [String!]!
  
  """
  Whether results were truncated
  """
  truncated: Boolean!
}

# =================================================================
# NOTIFICATION TYPES
# =================================================================

"""
Notification types
"""
enum NotificationType {
  INFO
  SUCCESS
  WARNING
  ERROR
}

"""
Notification
"""
type Notification implements Node {
  """
  Unique identifier
  """
  id: UUID!
  
  """
  Notification type
  """
  type: NotificationType!
  
  """
  Title
  """
  title: String!
  
  """
  Message content
  """
  message: String!
  
  """
  Whether notification was read
  """
  is_read: Boolean!
  
  """
  Related resource ID
  """
  resource_id: UUID
  
  """
  Related resource type
  """
  resource_type: String
  
  """
  Action URL
  """
  action_url: String
  
  """
  Action label
  """
  action_label: String
  
  """
  Additional data
  """
  data: JSON
  
  """
  When the notification was created
  """
  created_at: DateTime!
  
  """
  When the notification was read
  """
  read_at: DateTime
  
  """
  When the notification expires
  """
  expires_at: DateTime
}

# =================================================================
# SUBSCRIPTION TYPES
# =================================================================

"""
Subscription event types
"""
enum SubscriptionEventType {
  CREATED
  UPDATED
  DELETED
  STATUS_CHANGED
  BULK_OPERATION
  SYSTEM_EVENT
}

"""
Base subscription event
"""
interface SubscriptionEvent {
  """
  Event type
  """
  type: SubscriptionEventType!
  
  """
  Tenant ID
  """
  tenant_id: UUID!
  
  """
  User who triggered the event
  """
  user_id: UUID
  
  """
  Event timestamp
  """
  timestamp: DateTime!
  
  """
  Event metadata
  """
  metadata: JSON
}